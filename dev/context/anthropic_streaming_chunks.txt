
=== Testing Anthropic Text Streaming ===


--- CHUNK 1 ---
  ROLE: assistant
  CONTENT: '1'

--- CHUNK 2 ---
  CONTENT: '\n2\n3\n4\n5'

--- CHUNK 3 ---
  FINISH_REASON: stop

=== Total chunks: 3 ===


=== Testing Anthropic Tool Call Streaming ===


--- CHUNK 1 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "I'll check",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null,
  "citations": null,
  "service_tier": null
}
  → ROLE: assistant
  → CONTENT: "I'll check"

--- CHUNK 2 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": " the current",
        "role": null,
        "function_call": null,
        "tool_calls": null,
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null,
  "citations": null,
  "service_tier": null
}
  → CONTENT: ' the current'

--- CHUNK 3 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": " weather in Tokyo for you.",
        "role": null,
        "function_call": null,
        "tool_calls": null,
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null,
  "citations": null,
  "service_tier": null
}
  → CONTENT: ' weather in Tokyo for you.'

--- CHUNK 4 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "",
        "role": null,
        "function_call": null,
        "tool_calls": [
          {
            "id": "toolu_01NXdbZJaGgRUyM5CJYfXn8L",
            "function": {
              "arguments": "",
              "name": "get_weather"
            },
            "type": "function",
            "index": 0
          }
        ],
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → TOOL_CALLS: [{'id': 'toolu_01NXdbZJaGgRUyM5CJYfXn8L', 'function': {'arguments': '', 'name': 'get_weather'}, 'type': 'function', 'index': 0}]

--- CHUNK 5 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "",
        "role": null,
        "function_call": null,
        "tool_calls": [
          {
            "id": null,
            "function": {
              "arguments": "",
              "name": null
            },
            "type": "function",
            "index": 0
          }
        ],
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → TOOL_CALLS: [{'id': None, 'function': {'arguments': '', 'name': None}, 'type': 'function', 'index': 0}]

--- CHUNK 6 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "",
        "role": null,
        "function_call": null,
        "tool_calls": [
          {
            "id": null,
            "function": {
              "arguments": "{\"l",
              "name": null
            },
            "type": "function",
            "index": 0
          }
        ],
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → TOOL_CALLS: [{'id': None, 'function': {'arguments': '{"l', 'name': None}, 'type': 'function', 'index': 0}]

--- CHUNK 7 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "",
        "role": null,
        "function_call": null,
        "tool_calls": [
          {
            "id": null,
            "function": {
              "arguments": "ocation\": ",
              "name": null
            },
            "type": "function",
            "index": 0
          }
        ],
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → TOOL_CALLS: [{'id': None, 'function': {'arguments': 'ocation": ', 'name': None}, 'type': 'function', 'index': 0}]

--- CHUNK 8 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": null,
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "refusal": null,
        "content": "",
        "role": null,
        "function_call": null,
        "tool_calls": [
          {
            "id": null,
            "function": {
              "arguments": "\"Tokyo\"}",
              "name": null
            },
            "type": "function",
            "index": 0
          }
        ],
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → TOOL_CALLS: [{'id': None, 'function': {'arguments': '"Tokyo"}', 'name': None}, 'type': 'function', 'index': 0}]

--- CHUNK 9 ---
{
  "id": "chatcmpl-810a96e1-4004-46e0-9ebd-d663dece4367",
  "created": 1761262972,
  "model": "claude-sonnet-4",
  "object": "chat.completion.chunk",
  "system_fingerprint": null,
  "choices": [
    {
      "finish_reason": "tool_calls",
      "index": 0,
      "delta": {
        "provider_specific_fields": null,
        "content": null,
        "role": null,
        "function_call": null,
        "tool_calls": null,
        "audio": null
      },
      "logprobs": null
    }
  ],
  "provider_specific_fields": null
}
  → FINISH_REASON: tool_calls

=== Total chunks: 9 ===
